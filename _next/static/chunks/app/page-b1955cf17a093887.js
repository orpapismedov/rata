(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{682:(e,t,s)=>{Promise.resolve().then(s.bind(s,5973))},1779:(e,t,s)=>{"use strict";s.d(t,{YG:()=>l,hd:()=>o,sendExpiryReminder:()=>c,wX:()=>n});var r=s(5518),a=s(1890);let i=()=>{let e={serviceId:a.env.NEXT_PUBLIC_EMAILJS_SERVICE_ID,templateId:a.env.NEXT_PUBLIC_EMAILJS_TEMPLATE_ID,publicKey:a.env.NEXT_PUBLIC_EMAILJS_PUBLIC_KEY};if(e.serviceId&&e.templateId&&e.publicKey)return e;{let e=localStorage.getItem("emailjs-config");return e?JSON.parse(e):null}},l=()=>{let e=i();return!!e&&!!e.publicKey&&(r.Ay.init(e.publicKey),!0)},n=()=>{let e=i();return!!(e&&e.serviceId&&e.templateId&&e.publicKey)},c=async e=>{try{let t=i();if(!t||!t.serviceId||!t.templateId)throw Error("EmailJS configuration not found");let s={to_name:e.pilotName,to_email:e.pilotEmail,certificate_type:"medical"===e.licenseType?"תעודה רפואית":"רישיון מדריך",expiry_date:e.expiryDate,days_until_expiry:e.daysUntilExpiry,from_name:"מערכת ניהול רישיונות UAV"},a=await r.Ay.send(t.serviceId,t.templateId,s);return console.log("Email sent successfully:",a.status,a.text),!0}catch(e){return console.error("Failed to send email:",e),!1}},o=async(e,t)=>{let s=new Date("medical"===t?e.healthCertificateExpiry:e.instructorLicenseExpiry),r=new Date,a=Math.ceil((s.getTime()-r.getTime())/864e5);return await c({pilotName:"".concat(e.firstName," ").concat(e.lastName),pilotEmail:e.email,licenseType:t,expiryDate:s.toLocaleDateString("he-IL"),daysUntilExpiry:a})}},5973:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>en});var r=s(5155),a=s(2115),i=s(6408),l=s(760),n=s(4416),c=s(7580),o=s(9037),d=s(5525),x=s(7298),m=s(2713),u=s(8883),p=s(4616),h=s(1007),g=s(3717),y=s(2525),b=s(646),f=s(4186),N=s(9434),j=s(5317),v=s(3915),w=s(6203),E=s(858),I=s(6864);let C=(0,v.Wp)({apiKey:"AIzaSyA3smogMFlRvFMSjJbJiB10_vwtMPiEzAg",authDomain:"rata-9e69e.firebaseapp.com",projectId:"rata-9e69e",storageBucket:"rata-9e69e.firebasestorage.app",messagingSenderId:"778749184463",appId:"1:778749184463:web:1513cc7e0c28fc5ec6eaba",measurementId:"G-3FSNE2C27M"}),S=(0,j.aU)(C);(0,w.xI)(C),(0,E.c7)(C),(0,I.P5)(C);let D="pilots",k=e=>e&&"object"==typeof e&&"toDate"in e?e.toDate():new Date(e&&"object"==typeof e&&"seconds"in e?1e3*e.seconds:e),_=e=>j.Dc.fromDate(e),L=async()=>{try{let e=(0,j.P)((0,j.rJ)(S,D),(0,j.My)("createdAt","desc"));return(await (0,j.GG)(e)).docs.map(e=>{let t=e.data();return{id:e.id,firstName:t.firstName,lastName:t.lastName,email:t.email,rataCertification:t.rataCertification,categories:t.categories||[t.category].filter(Boolean),healthCertificateExpiry:k(t.healthCertificateExpiry),isInstructor:t.isInstructor,instructorLicenseExpiry:t.instructorLicenseExpiry?k(t.instructorLicenseExpiry):void 0,restrictions:t.restrictions,customRestrictions:t.customRestrictions,createdAt:k(t.createdAt),updatedAt:t.updatedAt?k(t.updatedAt):void 0}})}catch(e){throw console.error("Error fetching pilots:",e),e}},P=async e=>{try{let t={firstName:e.firstName,lastName:e.lastName,email:e.email,rataCertification:e.rataCertification,categories:e.categories,healthCertificateExpiry:_(e.healthCertificateExpiry),isInstructor:e.isInstructor,instructorLicenseExpiry:e.instructorLicenseExpiry?_(e.instructorLicenseExpiry):null,restrictions:e.restrictions,customRestrictions:e.customRestrictions||"",createdAt:_(new Date)};return{id:(await (0,j.gS)((0,j.rJ)(S,D),t)).id,...e,createdAt:new Date}}catch(e){throw console.error("Error adding pilot:",e),e}},A=async(e,t)=>{try{let s={firstName:t.firstName,lastName:t.lastName,email:t.email,rataCertification:t.rataCertification,categories:t.categories,healthCertificateExpiry:_(t.healthCertificateExpiry),isInstructor:t.isInstructor,instructorLicenseExpiry:t.instructorLicenseExpiry?_(t.instructorLicenseExpiry):null,restrictions:t.restrictions,customRestrictions:t.customRestrictions||"",updatedAt:_(new Date)};await (0,j.mZ)((0,j.H9)(S,D,e),s)}catch(e){throw console.error("Error updating pilot:",e),e}},T=async e=>{try{await (0,j.kd)((0,j.H9)(S,D,e))}catch(e){throw console.error("Error deleting pilot:",e),e}};var M=s(381),J=s(1243),B=s(1284),O=s(2486),F=s(1779);let U="last-email-check",Y="sent-reminders",R=()=>{let e=localStorage.getItem(Y);return e?JSON.parse(e):[]},H=(e,t,s)=>{let r=R(),a={pilotId:e,licenseType:t,expiryDate:s.toISOString(),dateSent:new Date().toISOString()};r.push(a),localStorage.setItem(Y,JSON.stringify(r))},$=(e,t,s)=>R().some(r=>r.pilotId===e&&r.licenseType===t&&r.expiryDate===s.toISOString()),K=()=>{let e=localStorage.getItem(U);if(!e)return!0;let t=new Date(e);return(new Date().getTime()-t.getTime())/36e5>=24},X=async e=>{let t=new Date;for(let r of(console.log("\uD83D\uDCC5 Today is: ".concat(t.toLocaleDateString("he-IL"))),e)){if(!r.id)continue;console.log("\uD83D\uDC64 Checking pilot: ".concat(r.firstName," ").concat(r.lastName));let e=new Date(r.healthCertificateExpiry),a=Math.ceil((e.getTime()-t.getTime())/864e5);if(console.log("\uD83C\uDFE5 Medical certificate expires: ".concat(e.toLocaleDateString("he-IL")," (").concat(a," days left)")),45===a)if(console.log("\uD83C\uDFAF Medical certificate expires in exactly 45 days!"),$(r.id,"medical",e))console.log("⏭️ Medical reminder already sent to ".concat(r.firstName," ").concat(r.lastName));else{console.log("\uD83D\uDCE7 Sending medical reminder to ".concat(r.email));try{let{sendExpiryReminder:t}=await Promise.resolve().then(s.bind(s,1779));await t({pilotName:"".concat(r.firstName," ").concat(r.lastName),pilotEmail:r.email,licenseType:"medical",expiryDate:e.toLocaleDateString("he-IL"),daysUntilExpiry:a})?(H(r.id,"medical",e),console.log("✅ Medical certificate reminder sent to ".concat(r.firstName," ").concat(r.lastName))):console.log("❌ Failed to send medical reminder to ".concat(r.firstName," ").concat(r.lastName))}catch(e){console.error("❌ Error sending medical reminder to ".concat(r.firstName," ").concat(r.lastName,":"),e)}}if(r.isInstructor&&r.instructorLicenseExpiry){let e=new Date(r.instructorLicenseExpiry),a=Math.ceil((e.getTime()-t.getTime())/864e5);if(console.log("\uD83D\uDC68‍\uD83C\uDFEB Instructor license expires: ".concat(e.toLocaleDateString("he-IL")," (").concat(a," days left)")),45===a)if(console.log("\uD83C\uDFAF Instructor license expires in exactly 45 days!"),$(r.id,"instructor",e))console.log("⏭️ Instructor reminder already sent to ".concat(r.firstName," ").concat(r.lastName));else{console.log("\uD83D\uDCE7 Sending instructor reminder to ".concat(r.email));try{let{sendExpiryReminder:t}=await Promise.resolve().then(s.bind(s,1779));await t({pilotName:"".concat(r.firstName," ").concat(r.lastName),pilotEmail:r.email,licenseType:"instructor",expiryDate:e.toLocaleDateString("he-IL"),daysUntilExpiry:a})?(H(r.id,"instructor",e),console.log("✅ Instructor license reminder sent to ".concat(r.firstName," ").concat(r.lastName))):console.log("❌ Failed to send instructor reminder to ".concat(r.firstName," ").concat(r.lastName))}catch(e){console.error("❌ Error sending instructor reminder to ".concat(r.firstName," ").concat(r.lastName,":"),e)}}}}},z=async e=>{if(console.log("\uD83D\uDD0D Starting automatic email check..."),!K())return void console.log("⏰ Skipping check - already checked today");try{if(!(0,F.wX)())return void console.log("❌ EmailJS not configured - please set environment variables or configure via admin panel");if(!(0,F.YG)())return void console.log("❌ Failed to initialize EmailJS");console.log("✅ EmailJS configured and initialized, checking pilots..."),console.log("\uD83D\uDC65 Found ".concat(e.length," pilots to check")),await X(e),localStorage.setItem(U,new Date().toISOString()),console.log("✅ Automatic email check completed")}catch(e){console.error("❌ Error in automatic email check:",e)}},q=async e=>{console.log("\uD83D\uDD04 Forcing email check..."),await X(e),localStorage.setItem(U,new Date().toISOString())},G=()=>{localStorage.removeItem(U),console.log("\uD83D\uDD04 Daily check timer reset - next check will run immediately")},V=()=>{let e=R(),t=new Date;t.setFullYear(t.getFullYear()-1);let s=e.filter(e=>new Date(e.dateSent)>t);localStorage.setItem(Y,JSON.stringify(s))},Q=e=>{console.log("\uD83D\uDC1B EMAIL SYSTEM DEBUG INFO:"),console.log("\uD83D\uDCC5 Today:",new Date().toLocaleDateString("he-IL"));let t=localStorage.getItem("emailjs-config"),s=t?JSON.parse(t):null;console.log("⚙️ EmailJS configured:",!!(null==s?void 0:s.serviceId));let r=localStorage.getItem(U);console.log("⏰ Last check:",r?new Date(r).toLocaleString("he-IL"):"Never"),console.log("\uD83D\uDD04 Should run check:",K()),console.log("\uD83D\uDCE7 Sent reminders count:",R().length),console.log("\uD83D\uDC65 Pilots with licenses expiring in 45 days:");let a=new Date;e.forEach(e=>{let t=Math.ceil((e.healthCertificateExpiry.getTime()-a.getTime())/864e5),s=e.instructorLicenseExpiry?Math.ceil((e.instructorLicenseExpiry.getTime()-a.getTime())/864e5):null;if(45===t||45===s){if(console.log("  \uD83D\uDC64 ".concat(e.firstName," ").concat(e.lastName,":")),45===t){let s=$(e.id,"medical",e.healthCertificateExpiry);console.log("    \uD83C\uDFE5 Medical: ".concat(t," days (reminder sent: ").concat(s,")"))}if(45===s){let t=$(e.id,"instructor",e.instructorLicenseExpiry);console.log("    \uD83D\uDC68‍\uD83C\uDFEB Instructor: ".concat(s," days (reminder sent: ").concat(t,")"))}}})},W="uav_admin_session",Z=()=>{try{let e=localStorage.getItem(W);if(!e)return!1;let t=JSON.parse(e);if(Date.now()-t.timestamp>72e5)return localStorage.removeItem(W),!1;return t.isAdmin}catch(e){return console.error("Error checking admin session:",e),!1}},ee=e=>{if("12891289"===e){let e={isAdmin:!0,timestamp:Date.now()};return localStorage.setItem(W,JSON.stringify(e)),!0}return!1},et=()=>{localStorage.removeItem(W)};function es(e){let{children:t,fallback:s,errorMessage:a="אין לך הרשאות מנהל לביצוע פעולה זו"}=e;return Z()?(0,r.jsx)(r.Fragment,{children:t}):s?(0,r.jsx)(r.Fragment,{children:s}):(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:[(0,r.jsx)("div",{className:"text-red-600 font-medium mb-2",children:"\uD83D\uDEAB גישה נדחתה"}),(0,r.jsx)("div",{className:"text-red-700 text-sm",children:a})]})}var er=s(1890);function ea(e){let{pilots:t,onClose:s}=e,[l,c]=(0,a.useState)(""),[o,d]=(0,a.useState)(""),[x,m]=(0,a.useState)(""),[p,h]=(0,a.useState)(!1),[g,y]=(0,a.useState)(!1),[f,N]=(0,a.useState)(!1),[j,v]=(0,a.useState)(null),[w,E]=(0,a.useState)("none");(0,a.useEffect)(()=>{if(er.env.NEXT_PUBLIC_EMAILJS_SERVICE_ID&&er.env.NEXT_PUBLIC_EMAILJS_TEMPLATE_ID&&er.env.NEXT_PUBLIC_EMAILJS_PUBLIC_KEY)E("env"),h(!0),c(er.env.NEXT_PUBLIC_EMAILJS_SERVICE_ID||""),d(er.env.NEXT_PUBLIC_EMAILJS_TEMPLATE_ID||""),m(er.env.NEXT_PUBLIC_EMAILJS_PUBLIC_KEY||"");else{let e=localStorage.getItem("emailjs-config");if(e){let t=JSON.parse(e);c(t.serviceId||""),d(t.templateId||""),m(t.publicKey||"");let s=!!(t.serviceId&&t.templateId&&t.publicKey);h(s),E(s?"localStorage":"none")}}let e=localStorage.getItem("last-email-check");e&&v(new Date(e))},[]);let I=async()=>{if(!p)return void alert("נא להגדיר את הגדרות EmailJS תחילה");N(!0);try{await q(t),v(new Date),alert("בדיקת רישיונות הושלמה בהצלחה! נשלחו התראות רק למטיסים עם רישיונות הפגים בדיוק בעוד 45 ימים.")}catch(e){console.error("Error checking reminders:",e),alert("שגיאה בבדיקת רישיונות")}finally{N(!1)}},C=async()=>{if(p&&0!==t.length){N(!0);try{let e=t[0];await (0,F.hd)(e,"medical"),alert("אימייל בדיקה נשלח בהצלחה!")}catch(e){console.error("Error sending test email:",e),alert("שגיאה בשליחת אימייל בדיקה")}finally{N(!1)}}},S=(()=>{let e=new Date,s=[];for(let r of t){let t=Math.ceil((r.healthCertificateExpiry.getTime()-e.getTime())/864e5);if(45===t&&s.push({pilot:r,type:"medical",days:t,expiry:r.healthCertificateExpiry}),r.isInstructor&&r.instructorLicenseExpiry){let t=Math.ceil((r.instructorLicenseExpiry.getTime()-e.getTime())/864e5);45===t&&s.push({pilot:r,type:"instructor",days:t,expiry:r.instructorLicenseExpiry})}}return s})();return(0,r.jsx)(i.P.div,{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{direction:"rtl"},children:(0,r.jsxs)(i.P.div,{className:"bg-gray-900/95 backdrop-blur-lg border border-gray-700 rounded-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto relative shadow-2xl",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[(0,r.jsx)("button",{onClick:s,className:"absolute top-4 left-4 p-2 hover:bg-gray-800 rounded-full transition-colors",children:(0,r.jsx)(n.A,{className:"w-5 h-5 text-gray-400"})}),(0,r.jsxs)("h3",{className:"text-2xl font-bold text-white mb-6 text-center flex items-center justify-center gap-3",children:[(0,r.jsx)(u.A,{className:"w-8 h-8 text-blue-400"}),"מערכת התראות מייל"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(es,{errorMessage:"אין לך הרשאות מנהל לשינוי הגדרות EmailJS",children:(0,r.jsxs)("div",{className:"bg-gray-800/50 rounded-xl p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("h4",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[(0,r.jsx)(M.A,{className:"w-5 h-5"}),"הגדרות EmailJS"]}),(0,r.jsx)("button",{onClick:()=>y(!g),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm",children:g?"הסתר":"הגדר"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[p?(0,r.jsx)(b.A,{className:"w-5 h-5 text-green-400"}):(0,r.jsx)(J.A,{className:"w-5 h-5 text-yellow-400"}),(0,r.jsx)("span",{className:"text-sm ".concat(p?"text-green-400":"text-yellow-400"),children:p?"מוגדר ומוכן לשימוש ".concat("env"===w?"(משתני סביבה)":"(הגדרות מקומיות)"):"דרוש הגדרה"})]}),"env"===w&&(0,r.jsx)("div",{className:"bg-blue-900/30 border border-blue-700 rounded-lg p-3 mb-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 text-blue-300 text-sm",children:[(0,r.jsx)(B.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"הגדרות EmailJS מוגדרות באמצעות משתני סביבה - ההגדרות יפעלו בכל מכשיר"})]})}),"none"===w&&(0,r.jsx)("div",{className:"bg-amber-900/30 border border-amber-700 rounded-lg p-3 mb-4",children:(0,r.jsxs)("div",{className:"text-amber-300 text-sm",children:[(0,r.jsx)("p",{className:"font-medium mb-2",children:"לשימוש מלא במערכת, נדרש להגדיר EmailJS:"}),(0,r.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,r.jsxs)("p",{children:["\uD83D\uDD27 ",(0,r.jsx)("strong",{children:"באמצעות משתני סביבה (מומלץ):"})]}),(0,r.jsx)("p",{className:"ml-4",children:"הוסף ל-.env.local:"}),(0,r.jsxs)("code",{className:"block bg-black/30 p-2 rounded mt-1 font-mono",children:["NEXT_PUBLIC_EMAILJS_SERVICE_ID=your_service_id",(0,r.jsx)("br",{}),"NEXT_PUBLIC_EMAILJS_TEMPLATE_ID=your_template_id",(0,r.jsx)("br",{}),"NEXT_PUBLIC_EMAILJS_PUBLIC_KEY=your_public_key"]}),(0,r.jsxs)("p",{className:"mt-2",children:["\uD83D\uDCF1 ",(0,r.jsx)("strong",{children:"באמצעות ההגדרות המקומיות:"}),' לחץ "הגדר" למטה']})]})]})}),g&&"env"!==w&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Service ID"}),(0,r.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"your_service_id",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Template ID"}),(0,r.jsx)("input",{type:"text",value:o,onChange:e=>d(e.target.value),placeholder:"your_template_id",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Public Key"}),(0,r.jsx)("input",{type:"text",value:x,onChange:e=>m(e.target.value),placeholder:"your_public_key",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white text-sm"})]}),(0,r.jsx)("button",{onClick:()=>{localStorage.setItem("emailjs-config",JSON.stringify({serviceId:l,templateId:o,publicKey:x})),h(!!(l&&o&&x)),y(!1),(0,F.YG)()},className:"w-full py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"שמור הגדרות"})]})]})}),(0,r.jsxs)("div",{className:"bg-gray-800/50 rounded-xl p-4 space-y-3",children:[(0,r.jsx)("h4",{className:"text-lg font-semibold text-white",children:"פעולות"}),(0,r.jsxs)("button",{onClick:I,disabled:!p||f,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center justify-center gap-2",children:[(0,r.jsx)(O.A,{className:"w-5 h-5"}),f?"שולח...":"בדוק ושלח התראות (45 ימים בדיוק)"]}),(0,r.jsx)("button",{onClick:async()=>{G(),await I()},disabled:!p||f,className:"w-full py-2 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors text-sm",children:"איפוס ובדיקה מחדש (לבדיקות)"}),(0,r.jsx)("button",{onClick:()=>V(),className:"w-full py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors text-sm",children:"נקה התראות ישנות"}),(0,r.jsx)("button",{onClick:()=>Q(t),className:"w-full py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors text-sm",children:"\uD83D\uDC1B Debug Info (בקונסול)"}),(0,r.jsx)("button",{onClick:C,disabled:!p||f||0===t.length,className:"w-full py-2 bg-yellow-600 hover:bg-yellow-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors text-sm",children:"שלח אימייל בדיקה"}),j&&(0,r.jsxs)("p",{className:"text-xs text-gray-400 text-center",children:["בדיקה אחרונה: ",j.toLocaleString("he-IL")]})]})]}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"bg-gray-800/50 rounded-xl p-4",children:[(0,r.jsxs)("h4",{className:"text-lg font-semibold text-white mb-4",children:["רישיונות הפגים בדיוק בעוד 45 ימים (",S.length,")"]}),(0,r.jsx)("div",{className:"max-h-96 overflow-y-auto space-y-2",children:0===S.length?(0,r.jsx)("p",{className:"text-gray-400 text-center py-4",children:"אין רישיונות הפגים בדיוק בעוד 45 ימים"}):S.map((e,t)=>(0,r.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsxs)("span",{className:"font-medium text-white",children:[e.pilot.firstName," ",e.pilot.lastName]}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs bg-orange-500/20 text-orange-300",children:"45 ימים בדיוק"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-300",children:"medical"===e.type?"תעודה רפואית":"רישיון מדריך"}),(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:["תאריך פג תוקף: ",e.expiry.toLocaleDateString("he-IL")]}),(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:['דוא"ל: ',e.pilot.email]})]},t))})]})})]}),(0,r.jsxs)("div",{className:"mt-6 bg-blue-900/20 border border-blue-700/30 rounded-lg p-4",children:[(0,r.jsx)("h5",{className:"font-semibold text-blue-300 mb-2",children:"מערכת התראות אוטומטית:"}),(0,r.jsxs)("ul",{className:"text-sm text-blue-200 space-y-1 mb-3",children:[(0,r.jsx)("li",{children:"• המערכת בודקת אוטומטית פעם ביום כאשר הדשבורד נטען"}),(0,r.jsx)("li",{children:"• נשלחת התראה **אחת בלבד** לכל מטיס, בדיוק 45 ימים לפני פג תוקף הרישיון"}),(0,r.jsx)("li",{children:"• ההתראה נשלחת גם לתעודה רפואית וגם לרישיון מדריך (אם רלוונטי)"}),(0,r.jsx)("li",{children:"• לא יישלחו התראות נוספות לאחר השליחה הראשונה"})]}),(0,r.jsx)("h5",{className:"font-semibold text-blue-300 mb-2",children:"הוראות הגדרה:"}),(0,r.jsxs)("ol",{className:"text-sm text-blue-200 space-y-1",children:[(0,r.jsx)("li",{children:"1. היכנס ל-EmailJS.com וצור חשבון"}),(0,r.jsx)("li",{children:"2. צור שירות חדש (Gmail/Outlook וכו')"}),(0,r.jsx)("li",{children:"3. צור תבנית אימייל עם המשתנים: to_name, to_email, certificate_type, expiry_date, days_until_expiry"}),(0,r.jsx)("li",{children:"4. העתק את ה-Service ID, Template ID ו-Public Key"}),(0,r.jsx)("li",{children:"5. הכנס את הפרטים בהגדרות למעלה"})]})]})]})})}function ei(e){let{onAdminStatusChange:t}=e,[s,i]=(0,a.useState)(Z()),[l,n]=(0,a.useState)(""),[c,o]=(0,a.useState)(!1),[d,x]=(0,a.useState)(""),m=()=>{ee(l)?(i(!0),n(""),o(!1),x(""),null==t||t(!0)):(x("סיסמה שגויה"),n(""))};return s?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-green-600 text-sm font-medium",children:"\uD83D\uDC64 מנהל מחובר"}),(0,r.jsx)("button",{onClick:()=>{et(),i(!1),o(!1),n(""),x(""),null==t||t(!1)},className:"px-3 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600 transition-colors",children:"התנתק"})]}):(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[c?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"password",value:l,onChange:e=>n(e.target.value),onKeyPress:e=>{"Enter"===e.key&&m()},placeholder:"סיסמת מנהל",className:"px-2 py-1 text-xs border rounded w-24 text-right bg-white text-black border-gray-300",autoFocus:!0}),(0,r.jsx)("button",{onClick:m,className:"px-2 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600 transition-colors",children:"✓"}),(0,r.jsx)("button",{onClick:()=>{o(!1),n(""),x("")},className:"px-2 py-1 text-xs bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"✕"})]}):(0,r.jsx)("button",{onClick:()=>o(!0),className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"\uD83D\uDD10 מנהל"}),d&&(0,r.jsx)("span",{className:"text-red-500 text-xs",children:d})]})}function el(e){let{onSubmit:t,onClose:s,initialData:l}=e,[c,o]=(0,a.useState)((null==l?void 0:l.firstName)||""),[d,x]=(0,a.useState)((null==l?void 0:l.lastName)||""),[m,u]=(0,a.useState)((null==l?void 0:l.email)||""),[p,h]=(0,a.useState)((null==l?void 0:l.rataCertification)||"IP"),[g,y]=(0,a.useState)((null==l?void 0:l.categories)||[]),[b,f]=(0,a.useState)((null==l?void 0:l.healthCertificateExpiry)?l.healthCertificateExpiry.toISOString().split("T")[0]:""),[N,j]=(0,a.useState)((null==l?void 0:l.isInstructor)||!1),[v,w]=(0,a.useState)((null==l?void 0:l.instructorLicenseExpiry)?l.instructorLicenseExpiry.toISOString().split("T")[0]:""),[E,I]=(0,a.useState)((null==l?void 0:l.restrictions)||"ללא"),[C,S]=(0,a.useState)((null==l?void 0:l.customRestrictions)||""),D=!!l,k=()=>{let e=new Date,t=new Date(e);return t.setFullYear(e.getFullYear()+2),t.toISOString().split("T")[0]};return(0,r.jsx)(i.P.div,{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{direction:"rtl"},children:(0,r.jsxs)(i.P.div,{className:"bg-gray-900/95 backdrop-blur-lg border border-gray-700 rounded-2xl p-6 max-w-sm w-full mx-4 relative shadow-2xl max-h-[90vh] overflow-y-auto",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[(0,r.jsx)("button",{onClick:s,className:"absolute top-4 left-4 p-2 hover:bg-gray-800 rounded-full transition-colors",children:(0,r.jsx)(n.A,{className:"w-5 h-5 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-2xl font-bold text-white mb-6 text-center",children:"הוסף מטיס חדש"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t({firstName:c.trim(),lastName:d.trim(),email:m.trim(),rataCertification:p,categories:g,healthCertificateExpiry:new Date(b),isInstructor:N,instructorLicenseExpiry:N&&v?new Date(v):void 0,restrictions:E,customRestrictions:"אחר"===E?C:void 0}),s()},className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"שם פרטי"}),(0,r.jsx)("input",{type:"text",value:c,onChange:e=>o(e.target.value),required:!0,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"שם משפחה"}),(0,r.jsx)("input",{type:"text",value:d,onChange:e=>x(e.target.value),required:!0,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:'כתובת דוא"ל'}),(0,r.jsx)("input",{type:"email",value:m,onChange:e=>u(e.target.value),required:!0,placeholder:"pilot@example.com",className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"הסמכת רתא"}),(0,r.jsxs)("select",{value:p,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[(0,r.jsx)("option",{value:"IP",children:"מטיס פנים (IP)"}),(0,r.jsx)("option",{value:"EP",children:"מטיס חוץ (EP)"}),(0,r.jsx)("option",{value:"BOTH",children:"שניהם"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:'קטגוריות כטמ"ם (ניתן לבחור מספר)'}),(0,r.jsx)("div",{className:"space-y-2",children:["כנף קבועה 25-2000 קג","כנף קבועה 0-25 קג","כנף קבועה דו מנועי 25-2000 קג","עילוי ממונע VTOL","רחפן 25-2000 קג","רחפן 0-25 קג"].map(e=>(0,r.jsxs)("label",{className:"flex items-center space-x-3 space-x-reverse",children:[(0,r.jsx)("input",{type:"checkbox",checked:g.includes(e),onChange:t=>{t.target.checked?y([...g,e]):y(g.filter(t=>t!==e))},className:"w-4 h-4 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500 focus:ring-2"}),(0,r.jsx)("span",{className:"text-sm text-gray-300",children:e})]},e))})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"תוקף תעודה רפואית"}),(0,r.jsx)("input",{type:"date",value:b,onChange:e=>f(e.target.value),required:!0,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"האם המטיס הוא מדריך מוסמך?"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"radio",name:"isInstructor",checked:!0===N,onChange:()=>j(!0),className:"ml-2 text-blue-500 focus:ring-blue-500"}),(0,r.jsx)("span",{className:"text-white",children:"כן"})]}),(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"radio",name:"isInstructor",checked:!1===N,onChange:()=>j(!1),className:"ml-2 text-blue-500 focus:ring-blue-500"}),(0,r.jsx)("span",{className:"text-white",children:"לא"})]})]})]}),N&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"תוקף רישיון מדריך"}),(0,r.jsx)("input",{type:"date",value:v,onChange:e=>w(e.target.value),min:new Date().toISOString().split("T")[0],max:k(),required:N,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:["תאריך מקסימלי: ",k()," (שנתיים מהיום)"]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"הגבלות ברישיון"}),(0,r.jsxs)("select",{value:E,onChange:e=>I(e.target.value),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[(0,r.jsx)("option",{value:"ללא",children:"ללא"}),(0,r.jsx)("option",{value:"שיגור והנצלה בלבד",children:"שיגור והנצלה בלבד"}),(0,r.jsx)("option",{value:"אחר",children:"אחר"})]})]}),"אחר"===E&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"פרט את ההגבלות"}),(0,r.jsx)("textarea",{value:C,onChange:e=>S(e.target.value),rows:3,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none",placeholder:"הסבר על ההגבלות..."})]}),(0,r.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,r.jsx)("button",{type:"submit",className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl",children:D?"עדכן מטיס":"הוסף מטיס"}),(0,r.jsx)("button",{type:"button",onClick:s,className:"px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-xl font-semibold transition-all duration-300 border border-gray-600",children:"ביטול"})]})]})]})})}function en(){let[e,t]=(0,a.useState)([]),[s,j]=(0,a.useState)(!1),[v,w]=(0,a.useState)(null),[E,I]=(0,a.useState)(!1),[C,S]=(0,a.useState)(null),[D,k]=(0,a.useState)(null),[_,M]=(0,a.useState)(!0),[J,B]=(0,a.useState)(!1),[O,F]=(0,a.useState)(!1);(0,a.useEffect)(()=>{F(Z())},[]),(0,a.useEffect)(()=>{(async()=>{try{M(!0);let e=await L();t(e),setTimeout(()=>{z(e)},2e3)}catch(e){console.error("Error loading pilots:",e)}finally{M(!1)}})()},[]);let U=function(e){let t=e.length,s=e.filter(e=>"IP"===e.rataCertification||"BOTH"===e.rataCertification),r=s.filter(e=>(0,N.$_)(e.healthCertificateExpiry)>0),a=e.filter(e=>"EP"===e.rataCertification||"BOTH"===e.rataCertification),i=a.filter(e=>(0,N.$_)(e.healthCertificateExpiry)>0),l=e.filter(e=>("IP"===e.rataCertification||"BOTH"===e.rataCertification)&&e.isInstructor),n=l.filter(e=>(e.instructorLicenseExpiry?(0,N.$_)(e.instructorLicenseExpiry):-1)>0),c=e.filter(e=>("EP"===e.rataCertification||"BOTH"===e.rataCertification)&&e.isInstructor),o=c.filter(e=>(e.instructorLicenseExpiry?(0,N.$_)(e.instructorLicenseExpiry):-1)>0),d=e.filter(e=>{let t=(0,N.$_)(e.healthCertificateExpiry),s=e.instructorLicenseExpiry?(0,N.$_)(e.instructorLicenseExpiry):null;return null!==t&&t<=45&&t>0||null!==s&&s<=45&&s>0}).length,x=e.filter(e=>{let t=(0,N.$_)(e.healthCertificateExpiry),s=e.instructorLicenseExpiry?(0,N.$_)(e.instructorLicenseExpiry):null;return null!==t&&t<=0||null!==s&&s<=0}).length;return{totalPilots:t,ipPilots:s.length,validIpPilots:r.length,epPilots:a.length,validEpPilots:i.length,ipInstructors:l.length,validIpInstructors:n.length,epInstructors:c.length,validEpInstructors:o.length,expiringPilots:d,expiredPilots:x}}(e),Y=[{title:"מטיסים פעילים",value:U.totalPilots.toString(),icon:c.A,trend:"+3 החודש",color:"text-blue-400",bgColor:"bg-blue-500/10"},{title:"רישיונות מטיס פנים תקפים",value:"".concat(U.validIpPilots," מתוך ").concat(U.ipPilots),icon:o.A,trend:"+2 החודש",color:"text-emerald-400",bgColor:"bg-emerald-500/10"},{title:"רישיונות מטיס חוץ תקפים",value:"".concat(U.validEpPilots," מתוך ").concat(U.epPilots),icon:d.A,trend:"+1 החודש",color:"text-purple-400",bgColor:"bg-purple-500/10"},{title:"רישיונות מדריך מטיס פנים תקפים",value:"".concat(U.validIpInstructors," מתוך ").concat(U.ipInstructors),icon:o.A,trend:"מדריכים פעילים",color:"text-cyan-400",bgColor:"bg-cyan-500/10"},{title:"רישיונות מדריך מטיס חוץ תקפים",value:"".concat(U.validEpInstructors," מתוך ").concat(U.epInstructors),icon:d.A,trend:"מדריכים פעילים",color:"text-indigo-400",bgColor:"bg-indigo-500/10"},{title:"כמות רשיונות לא בתוקף",value:U.expiredPilots.toString(),icon:n.A,trend:"נדרש חידוש",color:"text-red-400",bgColor:"bg-red-500/10"}],R=async s=>{try{let r=await P(s);t([...e,r])}catch(e){console.error("Error adding pilot:",e)}},H=async s=>{if(v&&v.id)try{await A(v.id,s);let r=e.map(e=>e.id===v.id?{...e,...s}:e);t(r),w(null)}catch(e){console.error("Error updating pilot:",e)}},$=e=>{if(!Z())return void alert("\uD83D\uDEAB אין לך הרשאות מנהל למחיקת מטיסים. יש להתחבר כמנהל תחילה.");k(e)},K=async()=>{if(D&&D.id)try{await T(D.id),t(e.filter(e=>e.id!==D.id)),k(null)}catch(e){console.error("Error deleting pilot:",e)}},X=e=>{let t=(0,N.go)(e.healthCertificateExpiry),s=(0,N.$_)(e.healthCertificateExpiry),r=null,a=null;return e.instructorLicenseExpiry&&(r=(0,N.go)(e.instructorLicenseExpiry),a=(0,N.$_)(e.instructorLicenseExpiry)),{healthStatus:t,healthDays:s,instructorStatus:r,instructorDays:a}},q=(e,t)=>(0,r.jsx)("span",{className:(0,N.cn)("px-2 py-1 text-xs rounded-full border",{expired:"bg-red-500/20 text-red-300 border-red-500/30",critical:"bg-orange-500/20 text-orange-300 border-orange-500/30",warning:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",good:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30"}[e]),children:t<0?"פג תוקף":"".concat(t," ימים")}),G=e.flatMap(e=>{let t=[],s=(0,N.$_)(e.healthCertificateExpiry);if(s<=45&&s>=0&&t.push({pilotName:"".concat(e.firstName," ").concat(e.lastName),type:"תעודה רפואית",days:s,date:e.healthCertificateExpiry}),e.instructorLicenseExpiry){let s=(0,N.$_)(e.instructorLicenseExpiry);s<=45&&s>=0&&t.push({pilotName:"".concat(e.firstName," ").concat(e.lastName),type:"רישיון מדריך",days:s,date:e.instructorLicenseExpiry})}return t}).sort((e,t)=>e.days-t.days);return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 relative overflow-hidden",style:{direction:"rtl"},children:[(0,r.jsxs)("div",{className:"absolute inset-0 opacity-30",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/10 to-purple-600/10"}),(0,r.jsx)("div",{className:"absolute inset-0 bg-[linear-gradient(90deg,transparent_24%,rgba(255,255,255,0.05)_25%,rgba(255,255,255,0.05)_26%,transparent_27%,transparent_74%,rgba(255,255,255,0.05)_75%,rgba(255,255,255,0.05)_76%,transparent_77%,transparent)] bg-[length:50px_50px]"})]}),_&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-gray-900/95 backdrop-blur-lg border border-gray-700 rounded-2xl p-8 flex flex-col items-center gap-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-400"}),(0,r.jsx)("p",{className:"text-white text-lg",children:"טוען נתונים..."})]})}),_&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"text-center text-white",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-400 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-lg",children:"טוען נתונים..."})]})}),(0,r.jsx)("header",{className:"relative z-10 bg-black/20 backdrop-blur-md border-b border-gray-700",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center h-14 sm:h-16",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)("div",{className:"flex-shrink-0 flex items-center",children:[(0,r.jsx)(x.A,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-400"}),(0,r.jsx)("span",{className:"mr-2 text-lg sm:text-xl font-bold text-white hidden sm:block",children:'מערכת ניהול רישיונות כטמ"ם'}),(0,r.jsx)("span",{className:"mr-2 text-sm font-bold text-white sm:hidden",children:'כטמ"ם אירונאוטיקס'})]})}),(0,r.jsx)(ei,{onAdminStatusChange:F})]})})}),(0,r.jsx)("main",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 sm:mb-8 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-white mb-2",children:'מערכת ניהול רשיונות כטמ"ם אירונאוטיקס'}),(0,r.jsx)("p",{className:"text-gray-400 text-sm sm:text-base",children:'ניהול רישיונות מטיסי כטמ"ם ותעודות רפואיות'})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)(i.P.button,{onClick:()=>I(!E),className:"group ".concat(E?"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700":"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700"," text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center gap-2 text-sm sm:text-base"),whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,r.jsx)(m.A,{className:"w-4 h-4 sm:w-5 sm:h-5"}),E?"הסתר סטטיסטיקה":"סטטיסטיקה"]}),(0,r.jsxs)(i.P.button,{onClick:()=>{if(!Z())return void alert("\uD83D\uDEAB אין לך הרשאות מנהל לגישה לאזור התראות המייל. יש להתחבר כמנהל תחילה.");B(!0)},className:"group bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center gap-2 text-sm sm:text-base",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,r.jsx)(u.A,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"התראות מייל"]}),(0,r.jsxs)(i.P.button,{onClick:()=>j(!0),className:"group bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center gap-2 text-sm sm:text-base",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,r.jsx)(p.A,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"הוסף מטיס"]})]})]}),E&&(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4 sm:gap-6 mb-8",children:Y.map((e,t)=>(0,r.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1*t},className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700 rounded-xl p-6 hover:bg-gray-800/60 transition-all duration-300",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:(0,N.cn)("p-3 rounded-lg",e.bgColor),children:(0,r.jsx)(e.icon,{className:(0,N.cn)("h-6 w-6",e.color)})}),(0,r.jsxs)("div",{className:"mr-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-400",children:e.title}),(0,r.jsx)("p",{className:"text-2xl font-semibold text-white",children:e.value})]})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("p",{className:"text-sm text-gray-500",children:e.trend})})]},e.title))}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 lg:gap-6",children:[(0,r.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},className:"lg:col-span-3 bg-gray-800/40 backdrop-blur-sm border border-gray-700 rounded-xl overflow-hidden order-2 lg:order-2",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-700",children:(0,r.jsx)("h2",{className:"text-lg font-semibold text-white",children:"רשימת מטיסים"})}),(0,r.jsx)("div",{className:"block lg:hidden",children:(0,r.jsx)("div",{className:"space-y-4 p-4",children:e.sort((e,t)=>"IP"===e.rataCertification&&"IP"!==t.rataCertification?-1:+("IP"===t.rataCertification&&"IP"!==e.rataCertification)).map((e,t)=>{let{healthStatus:s,healthDays:a,instructorStatus:l,instructorDays:n}=X(e);return(0,r.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*t},className:"bg-gray-700/30 rounded-xl p-4 space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-500/20 rounded-lg ml-3",children:(0,r.jsx)(h.A,{className:"h-4 w-4 text-blue-400"})}),(0,r.jsx)("div",{children:(0,r.jsxs)("button",{onClick:()=>S(e),className:"text-sm font-medium text-white hover:text-blue-400 transition-colors cursor-pointer",children:[e.firstName," ",e.lastName]})})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:()=>w(e),className:"text-blue-400 hover:text-blue-300 transition-colors flex items-center gap-1",children:[(0,r.jsx)(g.A,{className:"h-3 w-3"}),(0,r.jsx)("span",{className:"text-xs",children:"עריכה"})]}),(0,r.jsxs)("button",{onClick:()=>$(e),className:"text-red-400 hover:text-red-300 transition-colors flex items-center gap-1",children:[(0,r.jsx)(y.A,{className:"h-3 w-3"}),(0,r.jsx)("span",{className:"text-xs",children:"מחק"})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[("IP"===e.rataCertification||"BOTH"===e.rataCertification)&&(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-emerald-500/20 text-emerald-300",children:"מטיס פנים"}),("EP"===e.rataCertification||"BOTH"===e.rataCertification)&&(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-300",children:"מטיס חוץ"}),e.isInstructor&&(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-500/20 text-blue-300",children:"מדריך"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-400",children:"תעודה רפואית: "}),(0,r.jsx)("span",{className:"text-gray-300",children:(0,N.Yq)(e.healthCertificateExpiry)}),(0,r.jsx)("div",{className:"mt-1",children:q(s,a)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-400",children:"רישיון מדריך: "}),e.isInstructor&&e.instructorLicenseExpiry?(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-300",children:(0,N.Yq)(e.instructorLicenseExpiry)}),(0,r.jsx)("div",{className:"mt-1",children:q(l,n)})]}):e.isInstructor?(0,r.jsx)("span",{className:"text-yellow-400",children:"חסר תאריך"}):(0,r.jsx)("span",{className:"text-gray-500",children:"לא מדריך"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-400",children:"הגבלות: "}),(0,r.jsx)("span",{className:"text-gray-300",children:"אחר"===e.restrictions?e.customRestrictions:e.restrictions})]})]})]},e.id)})})}),(0,r.jsx)("div",{className:"hidden lg:block overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-800/60",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"מטיס"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"הסמכה"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"תוקף תעודה רפואית"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"תוקף רישיון מדריך"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"הגבלות"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"פעולות"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-700",children:e.sort((e,t)=>"IP"===e.rataCertification&&"IP"!==t.rataCertification?-1:+("IP"===t.rataCertification&&"IP"!==e.rataCertification)).map((e,t)=>{let{healthStatus:s,healthDays:a,instructorStatus:l,instructorDays:n}=X(e);return(0,r.jsxs)(i.P.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*t},className:"hover:bg-gray-700/30 transition-colors",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-500/20 rounded-lg ml-3",children:(0,r.jsx)(h.A,{className:"h-4 w-4 text-blue-400"})}),"                              ",(0,r.jsx)("div",{children:(0,r.jsxs)("button",{onClick:()=>S(e),className:"text-sm font-medium text-white hover:text-blue-400 transition-colors cursor-pointer",children:[e.firstName," ",e.lastName]})})]})}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[("IP"===e.rataCertification||"BOTH"===e.rataCertification)&&(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-500/20 text-emerald-300 whitespace-nowrap",children:"מטיס פנים"}),("EP"===e.rataCertification||"BOTH"===e.rataCertification)&&(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-500/20 text-purple-300 whitespace-nowrap",children:"מטיס חוץ"}),e.isInstructor&&(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-500/20 text-blue-300 whitespace-nowrap",children:"מדריך"})]})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsx)("div",{className:"text-sm text-gray-300",children:(0,N.Yq)(e.healthCertificateExpiry)}),q(s,a)]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.isInstructor&&e.instructorLicenseExpiry?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-gray-300",children:(0,N.Yq)(e.instructorLicenseExpiry)}),q(l,n)]}):e.isInstructor?(0,r.jsx)("span",{className:"text-yellow-400",children:"חסר תאריך"}):(0,r.jsx)("span",{className:"text-gray-500",children:"לא מדריך"})}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsx)("div",{className:"text-sm text-gray-300 max-w-xs",children:"אחר"===e.restrictions?e.customRestrictions:e.restrictions})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("button",{onClick:()=>w(e),className:"text-blue-400 hover:text-blue-300 transition-colors flex items-center gap-1 px-2 py-1 rounded hover:bg-blue-500/10",children:[(0,r.jsx)(g.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"text-xs",children:"עריכה"})]}),(0,r.jsxs)("button",{onClick:()=>$(e),className:"text-red-400 hover:text-red-300 transition-colors flex items-center gap-1 px-2 py-1 rounded hover:bg-red-500/10",children:[(0,r.jsx)(y.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"text-xs",children:"מחק"})]})]})})]},e.id)})})]})})]}),(0,r.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.5},className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700 rounded-xl order-1 lg:order-1",children:[(0,r.jsxs)("div",{className:"px-6 py-4 border-b border-gray-700",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white",children:"פגים בקרוב"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"תוקף של 45 ימים ומטה"})]}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"space-y-4",children:0===G.length?(0,r.jsxs)("div",{className:"text-center py-4",children:[(0,r.jsx)(b.A,{className:"h-12 w-12 text-emerald-400 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"אין פגים בקרוב"})]}):G.slice(0,5).map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-700/30 rounded-lg",children:[(0,r.jsx)("div",{className:"p-2 bg-orange-500/20 rounded-lg",children:(0,r.jsx)(f.A,{className:"h-4 w-4 text-orange-400"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-white",children:e.pilotName}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:e.type}),(0,r.jsxs)("p",{className:"text-xs text-orange-400",children:[e.days," ימים נותרו"]})]})]},t))})})]})]})]})}),(0,r.jsx)(l.N,{children:s&&(0,r.jsx)(el,{onSubmit:R,onClose:()=>j(!1)})}),(0,r.jsx)(l.N,{children:v&&(0,r.jsx)(el,{onSubmit:H,onClose:()=>w(null),initialData:v})}),(0,r.jsx)(l.N,{children:D&&(0,r.jsx)(i.P.div,{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{direction:"rtl"},children:(0,r.jsx)(i.P.div,{className:"bg-gray-900/95 backdrop-blur-lg border border-gray-700 rounded-2xl p-6 max-w-xs w-full mx-4 relative shadow-2xl",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-500/20 mb-4",children:(0,r.jsx)(y.A,{className:"h-6 w-6 text-red-400"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"מחיקת מטיס"}),(0,r.jsxs)("p",{className:"text-gray-400 mb-6",children:["האם אתה בטוח שברצונך למחוק את המטיס ",D.firstName," ",D.lastName,"?",(0,r.jsx)("br",{}),"פעולה זו לא ניתנת לביטול."]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("button",{onClick:K,className:"flex-1 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300",children:"כן, מחק"}),(0,r.jsx)("button",{onClick:()=>{k(null)},className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 border border-gray-600",children:"ביטול"})]})]})})})}),(0,r.jsx)(l.N,{children:C&&(0,r.jsx)(i.P.div,{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{direction:"rtl"},children:(0,r.jsxs)(i.P.div,{className:"bg-gray-900/95 backdrop-blur-lg border border-gray-700 rounded-2xl p-6 max-w-sm w-full mx-4 relative shadow-2xl max-h-[90vh] overflow-y-auto",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[(0,r.jsx)("button",{onClick:()=>S(null),className:"absolute top-4 left-4 p-2 hover:bg-gray-800 rounded-full transition-colors",children:(0,r.jsx)(n.A,{className:"w-5 h-5 text-gray-400"})}),(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-blue-500/20 mb-4",children:(0,r.jsx)(h.A,{className:"h-8 w-8 text-blue-400"})}),(0,r.jsxs)("h3",{className:"text-2xl font-bold text-white mb-2",children:[C.firstName," ",C.lastName]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-gray-800/40 rounded-xl p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"הסמכת רתא"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[("IP"===C.rataCertification||"BOTH"===C.rataCertification)&&(0,r.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-emerald-500/20 text-emerald-300",children:"מטיס פנים"}),("EP"===C.rataCertification||"BOTH"===C.rataCertification)&&(0,r.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-purple-500/20 text-purple-300",children:"מטיס חוץ"}),C.isInstructor&&(0,r.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-500/20 text-blue-300",children:"מדריך"})]})]}),(0,r.jsxs)("div",{className:"bg-gray-800/40 rounded-xl p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:'קטגוריות כטמ"ם'}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:C.categories&&C.categories.length>0?C.categories.map((e,t)=>(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-500/20 text-orange-300",children:e},t)):(0,r.jsx)("span",{className:"text-gray-500",children:"לא הוגדרו קטגוריות"})})]}),(0,r.jsxs)("div",{className:"bg-gray-800/40 rounded-xl p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"תעודה רפואית"}),(0,r.jsx)("p",{className:"text-white",children:(0,N.Yq)(C.healthCertificateExpiry)}),(0,r.jsx)("div",{className:"mt-2",children:(()=>{let e=(0,N.$_)(C.healthCertificateExpiry);return q((0,N.go)(C.healthCertificateExpiry),e)})()})]}),C.isInstructor&&(0,r.jsxs)("div",{className:"bg-gray-800/40 rounded-xl p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"רישיון מדריך"}),C.instructorLicenseExpiry?(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white",children:(0,N.Yq)(C.instructorLicenseExpiry)}),(0,r.jsx)("div",{className:"mt-2",children:(()=>{let e=(0,N.$_)(C.instructorLicenseExpiry);return q((0,N.go)(C.instructorLicenseExpiry),e)})()})]}):(0,r.jsx)("p",{className:"text-yellow-400",children:"חסר תאריך"})]}),(0,r.jsxs)("div",{className:"bg-gray-800/40 rounded-xl p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"הגבלות"}),(0,r.jsx)("p",{className:"text-white",children:"אחר"===C.restrictions?C.customRestrictions:C.restrictions})]})]}),(0,r.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,r.jsxs)("button",{onClick:()=>{w(C),S(null)},className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2",children:[(0,r.jsx)(g.A,{className:"w-4 h-4"}),"עריכה"]}),(0,r.jsxs)("button",{onClick:()=>{if(!Z())return void alert("\uD83D\uDEAB אין לך הרשאות מנהל למחיקת מטיסים. יש להתחבר כמנהל תחילה.");k(C),S(null)},className:"flex-1 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2",children:[(0,r.jsx)(y.A,{className:"w-4 h-4"}),"מחק"]})]})]})})}),(0,r.jsx)(l.N,{children:J&&(0,r.jsx)(ea,{pilots:e,onClose:()=>B(!1)})})]})}},9434:(e,t,s)=>{"use strict";s.d(t,{$_:()=>n,Yq:()=>l,cn:()=>i,go:()=>c});var r=s(2596),a=s(9688);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}function l(e){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(e)}function n(e){let t=new Date;return Math.ceil((new Date(e).getTime()-t.getTime())/864e5)}function c(e){let t=n(e);return t<0?"expired":t<=7?"critical":t<=30?"warning":"good"}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,811,436,622,441,684,358],()=>t(682)),_N_E=e.O()}]);