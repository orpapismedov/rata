(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{682:(e,t,r)=>{Promise.resolve().then(r.bind(r,5973))},1779:(e,t,r)=>{"use strict";r.d(t,{h:()=>n,initEmailJS:()=>i,sendExpiryReminder:()=>l});var s=r(5518);let a=()=>{{let e=localStorage.getItem("emailjs-config");return e?JSON.parse(e):null}},i=()=>{let e=a();return!!e&&!!e.publicKey&&(s.Ay.init(e.publicKey),!0)},l=async e=>{try{let t=a();if(!t||!t.serviceId||!t.templateId)throw Error("EmailJS configuration not found");let r={to_name:e.pilotName,to_email:e.pilotEmail,certificate_type:"medical"===e.licenseType?"תעודה רפואית":"רישיון מדריך",expiry_date:e.expiryDate,days_until_expiry:e.daysUntilExpiry,from_name:"מערכת ניהול רישיונות UAV"},i=await s.Ay.send(t.serviceId,t.templateId,r);return console.log("Email sent successfully:",i.status,i.text),!0}catch(e){return console.error("Failed to send email:",e),!1}},n=async(e,t)=>{let r=new Date("medical"===t?e.healthCertificateExpiry:e.instructorLicenseExpiry),s=new Date,a=Math.ceil((r.getTime()-s.getTime())/864e5);return await l({pilotName:"".concat(e.firstName," ").concat(e.lastName),pilotEmail:e.email,licenseType:t,expiryDate:r.toLocaleDateString("he-IL"),daysUntilExpiry:a})}},5973:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ei});var s=r(5155),a=r(2115),i=r(6408),l=r(760),n=r(4416),c=r(7580),o=r(9037),d=r(5525),x=r(7298),m=r(2713),u=r(8883),p=r(4616),h=r(1007),g=r(3717),y=r(2525),b=r(646),f=r(4186),N=r(9434),j=r(5317),v=r(3915),w=r(6203),E=r(858),C=r(6864);let S=(0,v.Wp)({apiKey:"AIzaSyA3smogMFlRvFMSjJbJiB10_vwtMPiEzAg",authDomain:"rata-9e69e.firebaseapp.com",projectId:"rata-9e69e",storageBucket:"rata-9e69e.firebasestorage.app",messagingSenderId:"778749184463",appId:"1:778749184463:web:1513cc7e0c28fc5ec6eaba",measurementId:"G-3FSNE2C27M"}),I=(0,j.aU)(S);(0,w.xI)(S),(0,E.c7)(S),(0,C.P5)(S);let D="pilots",k=e=>e&&"object"==typeof e&&"toDate"in e?e.toDate():new Date(e&&"object"==typeof e&&"seconds"in e?1e3*e.seconds:e),L=e=>j.Dc.fromDate(e),P=async()=>{try{let e=(0,j.P)((0,j.rJ)(I,D),(0,j.My)("createdAt","desc"));return(await (0,j.GG)(e)).docs.map(e=>{let t=e.data();return{id:e.id,firstName:t.firstName,lastName:t.lastName,email:t.email,rataCertification:t.rataCertification,category:t.category,healthCertificateExpiry:k(t.healthCertificateExpiry),isInstructor:t.isInstructor,instructorLicenseExpiry:t.instructorLicenseExpiry?k(t.instructorLicenseExpiry):void 0,restrictions:t.restrictions,customRestrictions:t.customRestrictions,createdAt:k(t.createdAt),updatedAt:t.updatedAt?k(t.updatedAt):void 0}})}catch(e){throw console.error("Error fetching pilots:",e),e}},A=async e=>{try{let t={firstName:e.firstName,lastName:e.lastName,email:e.email,rataCertification:e.rataCertification,category:e.category,healthCertificateExpiry:L(e.healthCertificateExpiry),isInstructor:e.isInstructor,instructorLicenseExpiry:e.instructorLicenseExpiry?L(e.instructorLicenseExpiry):null,restrictions:e.restrictions,customRestrictions:e.customRestrictions||"",createdAt:L(new Date)};return{id:(await (0,j.gS)((0,j.rJ)(I,D),t)).id,...e,createdAt:new Date}}catch(e){throw console.error("Error adding pilot:",e),e}},_=async(e,t)=>{try{let r={firstName:t.firstName,lastName:t.lastName,email:t.email,rataCertification:t.rataCertification,category:t.category,healthCertificateExpiry:L(t.healthCertificateExpiry),isInstructor:t.isInstructor,instructorLicenseExpiry:t.instructorLicenseExpiry?L(t.instructorLicenseExpiry):null,restrictions:t.restrictions,customRestrictions:t.customRestrictions||"",updatedAt:L(new Date)};await (0,j.mZ)((0,j.H9)(I,D,e),r)}catch(e){throw console.error("Error updating pilot:",e),e}},T=async e=>{try{await (0,j.kd)((0,j.H9)(I,D,e))}catch(e){throw console.error("Error deleting pilot:",e),e}};var O=r(381),F=r(1243),J=r(2486),M=r(1779);let B="last-email-check",H="sent-reminders",$=()=>{let e=localStorage.getItem(H);return e?JSON.parse(e):[]},q=(e,t,r)=>{let s=$(),a={pilotId:e,licenseType:t,expiryDate:r.toISOString(),dateSent:new Date().toISOString()};s.push(a),localStorage.setItem(H,JSON.stringify(s))},z=(e,t,r)=>$().some(s=>s.pilotId===e&&s.licenseType===t&&s.expiryDate===r.toISOString()),R=()=>{let e=localStorage.getItem(B);if(!e)return!0;let t=new Date(e);return(new Date().getTime()-t.getTime())/36e5>=24},Y=async e=>{let t=new Date;for(let s of(console.log("\uD83D\uDCC5 Today is: ".concat(t.toLocaleDateString("he-IL"))),e)){if(!s.id)continue;console.log("\uD83D\uDC64 Checking pilot: ".concat(s.firstName," ").concat(s.lastName));let e=new Date(s.healthCertificateExpiry),a=Math.ceil((e.getTime()-t.getTime())/864e5);if(console.log("\uD83C\uDFE5 Medical certificate expires: ".concat(e.toLocaleDateString("he-IL")," (").concat(a," days left)")),45===a)if(console.log("\uD83C\uDFAF Medical certificate expires in exactly 45 days!"),z(s.id,"medical",e))console.log("⏭️ Medical reminder already sent to ".concat(s.firstName," ").concat(s.lastName));else{console.log("\uD83D\uDCE7 Sending medical reminder to ".concat(s.email));try{let{sendExpiryReminder:t}=await Promise.resolve().then(r.bind(r,1779));await t({pilotName:"".concat(s.firstName," ").concat(s.lastName),pilotEmail:s.email,licenseType:"medical",expiryDate:e.toLocaleDateString("he-IL"),daysUntilExpiry:a})?(q(s.id,"medical",e),console.log("✅ Medical certificate reminder sent to ".concat(s.firstName," ").concat(s.lastName))):console.log("❌ Failed to send medical reminder to ".concat(s.firstName," ").concat(s.lastName))}catch(e){console.error("❌ Error sending medical reminder to ".concat(s.firstName," ").concat(s.lastName,":"),e)}}if(s.isInstructor&&s.instructorLicenseExpiry){let e=new Date(s.instructorLicenseExpiry),a=Math.ceil((e.getTime()-t.getTime())/864e5);if(console.log("\uD83D\uDC68‍\uD83C\uDFEB Instructor license expires: ".concat(e.toLocaleDateString("he-IL")," (").concat(a," days left)")),45===a)if(console.log("\uD83C\uDFAF Instructor license expires in exactly 45 days!"),z(s.id,"instructor",e))console.log("⏭️ Instructor reminder already sent to ".concat(s.firstName," ").concat(s.lastName));else{console.log("\uD83D\uDCE7 Sending instructor reminder to ".concat(s.email));try{let{sendExpiryReminder:t}=await Promise.resolve().then(r.bind(r,1779));await t({pilotName:"".concat(s.firstName," ").concat(s.lastName),pilotEmail:s.email,licenseType:"instructor",expiryDate:e.toLocaleDateString("he-IL"),daysUntilExpiry:a})?(q(s.id,"instructor",e),console.log("✅ Instructor license reminder sent to ".concat(s.firstName," ").concat(s.lastName))):console.log("❌ Failed to send instructor reminder to ".concat(s.firstName," ").concat(s.lastName))}catch(e){console.error("❌ Error sending instructor reminder to ".concat(s.firstName," ").concat(s.lastName,":"),e)}}}}},K=async e=>{if(console.log("\uD83D\uDD0D Starting automatic email check..."),!R())return void console.log("⏰ Skipping check - already checked today");try{let t=localStorage.getItem("emailjs-config");if(!t)return void console.log("❌ EmailJS not configured");let s=JSON.parse(t);if(!s.serviceId||!s.templateId||!s.publicKey)return void console.log("❌ EmailJS configuration incomplete");let{initEmailJS:a}=await Promise.resolve().then(r.bind(r,1779));if(!a())return void console.log("❌ Failed to initialize EmailJS");console.log("✅ EmailJS configured and initialized, checking pilots..."),console.log("\uD83D\uDC65 Found ".concat(e.length," pilots to check")),await Y(e),localStorage.setItem(B,new Date().toISOString()),console.log("✅ Automatic email check completed")}catch(e){console.error("❌ Error in automatic email check:",e)}},U=async e=>{console.log("\uD83D\uDD04 Forcing email check..."),await Y(e),localStorage.setItem(B,new Date().toISOString())},G=()=>{localStorage.removeItem(B),console.log("\uD83D\uDD04 Daily check timer reset - next check will run immediately")},V=()=>{let e=$(),t=new Date;t.setFullYear(t.getFullYear()-1);let r=e.filter(e=>new Date(e.dateSent)>t);localStorage.setItem(H,JSON.stringify(r))},Q=e=>{console.log("\uD83D\uDC1B EMAIL SYSTEM DEBUG INFO:"),console.log("\uD83D\uDCC5 Today:",new Date().toLocaleDateString("he-IL"));let t=localStorage.getItem("emailjs-config"),r=t?JSON.parse(t):null;console.log("⚙️ EmailJS configured:",!!(null==r?void 0:r.serviceId));let s=localStorage.getItem(B);console.log("⏰ Last check:",s?new Date(s).toLocaleString("he-IL"):"Never"),console.log("\uD83D\uDD04 Should run check:",R()),console.log("\uD83D\uDCE7 Sent reminders count:",$().length),console.log("\uD83D\uDC65 Pilots with licenses expiring in 45 days:");let a=new Date;e.forEach(e=>{let t=Math.ceil((e.healthCertificateExpiry.getTime()-a.getTime())/864e5),r=e.instructorLicenseExpiry?Math.ceil((e.instructorLicenseExpiry.getTime()-a.getTime())/864e5):null;if(45===t||45===r){if(console.log("  \uD83D\uDC64 ".concat(e.firstName," ").concat(e.lastName,":")),45===t){let r=z(e.id,"medical",e.healthCertificateExpiry);console.log("    \uD83C\uDFE5 Medical: ".concat(t," days (reminder sent: ").concat(r,")"))}if(45===r){let t=z(e.id,"instructor",e.instructorLicenseExpiry);console.log("    \uD83D\uDC68‍\uD83C\uDFEB Instructor: ".concat(r," days (reminder sent: ").concat(t,")"))}}})},W="uav_admin_session",Z=()=>{try{let e=localStorage.getItem(W);if(!e)return!1;let t=JSON.parse(e);if(Date.now()-t.timestamp>72e5)return localStorage.removeItem(W),!1;return t.isAdmin}catch(e){return console.error("Error checking admin session:",e),!1}},X=e=>{if("12891289"===e){let e={isAdmin:!0,timestamp:Date.now()};return localStorage.setItem(W,JSON.stringify(e)),!0}return!1},ee=()=>{localStorage.removeItem(W)};function et(e){let{children:t,fallback:r,errorMessage:a="אין לך הרשאות מנהל לביצוע פעולה זו"}=e;return Z()?(0,s.jsx)(s.Fragment,{children:t}):r?(0,s.jsx)(s.Fragment,{children:r}):(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:[(0,s.jsx)("div",{className:"text-red-600 font-medium mb-2",children:"\uD83D\uDEAB גישה נדחתה"}),(0,s.jsx)("div",{className:"text-red-700 text-sm",children:a})]})}function er(e){let{pilots:t,onClose:r}=e,[l,c]=(0,a.useState)(""),[o,d]=(0,a.useState)(""),[x,m]=(0,a.useState)(""),[p,h]=(0,a.useState)(!1),[g,y]=(0,a.useState)(!1),[f,N]=(0,a.useState)(!1),[j,v]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=localStorage.getItem("emailjs-config");if(e){let t=JSON.parse(e);c(t.serviceId||""),d(t.templateId||""),m(t.publicKey||""),h(!!(t.serviceId&&t.templateId&&t.publicKey))}},[]);let w=async()=>{if(!p)return void alert("נא להגדיר את הגדרות EmailJS תחילה");N(!0);try{await U(t),v(new Date),alert("בדיקת רישיונות הושלמה בהצלחה! נשלחו התראות רק למטיסים עם רישיונות הפגים בדיוק בעוד 45 ימים.")}catch(e){console.error("Error checking reminders:",e),alert("שגיאה בבדיקת רישיונות")}finally{N(!1)}},E=async()=>{if(p&&0!==t.length){N(!0);try{let e=t[0];await (0,M.h)(e,"medical"),alert("אימייל בדיקה נשלח בהצלחה!")}catch(e){console.error("Error sending test email:",e),alert("שגיאה בשליחת אימייל בדיקה")}finally{N(!1)}}},C=(()=>{let e=new Date,r=[];for(let s of t){let t=Math.ceil((s.healthCertificateExpiry.getTime()-e.getTime())/864e5);if(45===t&&r.push({pilot:s,type:"medical",days:t,expiry:s.healthCertificateExpiry}),s.isInstructor&&s.instructorLicenseExpiry){let t=Math.ceil((s.instructorLicenseExpiry.getTime()-e.getTime())/864e5);45===t&&r.push({pilot:s,type:"instructor",days:t,expiry:s.instructorLicenseExpiry})}}return r})();return(0,s.jsx)(i.P.div,{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{direction:"rtl"},children:(0,s.jsxs)(i.P.div,{className:"bg-gray-900/95 backdrop-blur-lg border border-gray-700 rounded-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto relative shadow-2xl",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[(0,s.jsx)("button",{onClick:r,className:"absolute top-4 left-4 p-2 hover:bg-gray-800 rounded-full transition-colors",children:(0,s.jsx)(n.A,{className:"w-5 h-5 text-gray-400"})}),(0,s.jsxs)("h3",{className:"text-2xl font-bold text-white mb-6 text-center flex items-center justify-center gap-3",children:[(0,s.jsx)(u.A,{className:"w-8 h-8 text-blue-400"}),"מערכת התראות מייל"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(et,{errorMessage:"אין לך הרשאות מנהל לשינוי הגדרות EmailJS",children:(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-xl p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[(0,s.jsx)(O.A,{className:"w-5 h-5"}),"הגדרות EmailJS"]}),(0,s.jsx)("button",{onClick:()=>y(!g),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm",children:g?"הסתר":"הגדר"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[p?(0,s.jsx)(b.A,{className:"w-5 h-5 text-green-400"}):(0,s.jsx)(F.A,{className:"w-5 h-5 text-yellow-400"}),(0,s.jsx)("span",{className:"text-sm ".concat(p?"text-green-400":"text-yellow-400"),children:p?"מוגדר ומוכן לשימוש":"דרוש הגדרה"})]}),g&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Service ID"}),(0,s.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"your_service_id",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Template ID"}),(0,s.jsx)("input",{type:"text",value:o,onChange:e=>d(e.target.value),placeholder:"your_template_id",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Public Key"}),(0,s.jsx)("input",{type:"text",value:x,onChange:e=>m(e.target.value),placeholder:"your_public_key",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white text-sm"})]}),(0,s.jsx)("button",{onClick:()=>{localStorage.setItem("emailjs-config",JSON.stringify({serviceId:l,templateId:o,publicKey:x})),h(!!(l&&o&&x)),y(!1),(0,M.initEmailJS)()},className:"w-full py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"שמור הגדרות"})]})]})}),(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-xl p-4 space-y-3",children:[(0,s.jsx)("h4",{className:"text-lg font-semibold text-white",children:"פעולות"}),(0,s.jsxs)("button",{onClick:w,disabled:!p||f,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center justify-center gap-2",children:[(0,s.jsx)(J.A,{className:"w-5 h-5"}),f?"שולח...":"בדוק ושלח התראות (45 ימים בדיוק)"]}),(0,s.jsx)("button",{onClick:async()=>{G(),await w()},disabled:!p||f,className:"w-full py-2 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors text-sm",children:"איפוס ובדיקה מחדש (לבדיקות)"}),(0,s.jsx)("button",{onClick:()=>V(),className:"w-full py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors text-sm",children:"נקה התראות ישנות"}),(0,s.jsx)("button",{onClick:()=>Q(t),className:"w-full py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors text-sm",children:"\uD83D\uDC1B Debug Info (בקונסול)"}),(0,s.jsx)("button",{onClick:E,disabled:!p||f||0===t.length,className:"w-full py-2 bg-yellow-600 hover:bg-yellow-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors text-sm",children:"שלח אימייל בדיקה"}),j&&(0,s.jsxs)("p",{className:"text-xs text-gray-400 text-center",children:["בדיקה אחרונה: ",j.toLocaleString("he-IL")]})]})]}),(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-xl p-4",children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold text-white mb-4",children:["רישיונות הפגים בדיוק בעוד 45 ימים (",C.length,")"]}),(0,s.jsx)("div",{className:"max-h-96 overflow-y-auto space-y-2",children:0===C.length?(0,s.jsx)("p",{className:"text-gray-400 text-center py-4",children:"אין רישיונות הפגים בדיוק בעוד 45 ימים"}):C.map((e,t)=>(0,s.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-3",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,s.jsxs)("span",{className:"font-medium text-white",children:[e.pilot.firstName," ",e.pilot.lastName]}),(0,s.jsx)("span",{className:"px-2 py-1 rounded-full text-xs bg-orange-500/20 text-orange-300",children:"45 ימים בדיוק"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-300",children:"medical"===e.type?"תעודה רפואית":"רישיון מדריך"}),(0,s.jsxs)("p",{className:"text-xs text-gray-400",children:["תאריך פג תוקף: ",e.expiry.toLocaleDateString("he-IL")]}),(0,s.jsxs)("p",{className:"text-xs text-gray-400",children:['דוא"ל: ',e.pilot.email]})]},t))})]})})]}),(0,s.jsxs)("div",{className:"mt-6 bg-blue-900/20 border border-blue-700/30 rounded-lg p-4",children:[(0,s.jsx)("h5",{className:"font-semibold text-blue-300 mb-2",children:"מערכת התראות אוטומטית:"}),(0,s.jsxs)("ul",{className:"text-sm text-blue-200 space-y-1 mb-3",children:[(0,s.jsx)("li",{children:"• המערכת בודקת אוטומטית פעם ביום כאשר הדשבורד נטען"}),(0,s.jsx)("li",{children:"• נשלחת התראה **אחת בלבד** לכל מטיס, בדיוק 45 ימים לפני פג תוקף הרישיון"}),(0,s.jsx)("li",{children:"• ההתראה נשלחת גם לתעודה רפואית וגם לרישיון מדריך (אם רלוונטי)"}),(0,s.jsx)("li",{children:"• לא יישלחו התראות נוספות לאחר השליחה הראשונה"})]}),(0,s.jsx)("h5",{className:"font-semibold text-blue-300 mb-2",children:"הוראות הגדרה:"}),(0,s.jsxs)("ol",{className:"text-sm text-blue-200 space-y-1",children:[(0,s.jsx)("li",{children:"1. היכנס ל-EmailJS.com וצור חשבון"}),(0,s.jsx)("li",{children:"2. צור שירות חדש (Gmail/Outlook וכו')"}),(0,s.jsx)("li",{children:"3. צור תבנית אימייל עם המשתנים: to_name, to_email, certificate_type, expiry_date, days_until_expiry"}),(0,s.jsx)("li",{children:"4. העתק את ה-Service ID, Template ID ו-Public Key"}),(0,s.jsx)("li",{children:"5. הכנס את הפרטים בהגדרות למעלה"})]})]})]})})}function es(e){let{onAdminStatusChange:t}=e,[r,i]=(0,a.useState)(Z()),[l,n]=(0,a.useState)(""),[c,o]=(0,a.useState)(!1),[d,x]=(0,a.useState)(""),m=()=>{X(l)?(i(!0),n(""),o(!1),x(""),null==t||t(!0)):(x("סיסמה שגויה"),n(""))};return r?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-green-600 text-sm font-medium",children:"\uD83D\uDC64 מנהל מחובר"}),(0,s.jsx)("button",{onClick:()=>{ee(),i(!1),o(!1),n(""),x(""),null==t||t(!1)},className:"px-3 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600 transition-colors",children:"התנתק"})]}):(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[c?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"password",value:l,onChange:e=>n(e.target.value),onKeyPress:e=>{"Enter"===e.key&&m()},placeholder:"סיסמת מנהל",className:"px-2 py-1 text-xs border rounded w-24 text-right bg-white text-black border-gray-300",autoFocus:!0}),(0,s.jsx)("button",{onClick:m,className:"px-2 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600 transition-colors",children:"✓"}),(0,s.jsx)("button",{onClick:()=>{o(!1),n(""),x("")},className:"px-2 py-1 text-xs bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"✕"})]}):(0,s.jsx)("button",{onClick:()=>o(!0),className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"\uD83D\uDD10 מנהל"}),d&&(0,s.jsx)("span",{className:"text-red-500 text-xs",children:d})]})}function ea(e){let{onSubmit:t,onClose:r,initialData:l}=e,[c,o]=(0,a.useState)((null==l?void 0:l.firstName)||""),[d,x]=(0,a.useState)((null==l?void 0:l.lastName)||""),[m,u]=(0,a.useState)((null==l?void 0:l.email)||""),[p,h]=(0,a.useState)((null==l?void 0:l.rataCertification)||"IP"),[g,y]=(0,a.useState)((null==l?void 0:l.category)||"כנף קבועה 25-2000 קג"),[b,f]=(0,a.useState)((null==l?void 0:l.healthCertificateExpiry)?l.healthCertificateExpiry.toISOString().split("T")[0]:""),[N,j]=(0,a.useState)((null==l?void 0:l.isInstructor)||!1),[v,w]=(0,a.useState)((null==l?void 0:l.instructorLicenseExpiry)?l.instructorLicenseExpiry.toISOString().split("T")[0]:""),[E,C]=(0,a.useState)((null==l?void 0:l.restrictions)||"ללא"),[S,I]=(0,a.useState)((null==l?void 0:l.customRestrictions)||""),D=!!l,k=()=>{let e=new Date,t=new Date(e);return t.setFullYear(e.getFullYear()+2),t.toISOString().split("T")[0]};return(0,s.jsx)(i.P.div,{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{direction:"rtl"},children:(0,s.jsxs)(i.P.div,{className:"bg-gray-900/95 backdrop-blur-lg border border-gray-700 rounded-2xl p-6 max-w-sm w-full mx-4 relative shadow-2xl max-h-[90vh] overflow-y-auto",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[(0,s.jsx)("button",{onClick:r,className:"absolute top-4 left-4 p-2 hover:bg-gray-800 rounded-full transition-colors",children:(0,s.jsx)(n.A,{className:"w-5 h-5 text-gray-400"})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-white mb-6 text-center",children:"הוסף מטיס חדש"}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t({firstName:c.trim(),lastName:d.trim(),email:m.trim(),rataCertification:p,category:g,healthCertificateExpiry:new Date(b),isInstructor:N,instructorLicenseExpiry:N&&v?new Date(v):void 0,restrictions:E,customRestrictions:"אחר"===E?S:void 0}),r()},className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"שם פרטי"}),(0,s.jsx)("input",{type:"text",value:c,onChange:e=>o(e.target.value),required:!0,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"שם משפחה"}),(0,s.jsx)("input",{type:"text",value:d,onChange:e=>x(e.target.value),required:!0,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:'כתובת דוא"ל'}),(0,s.jsx)("input",{type:"email",value:m,onChange:e=>u(e.target.value),required:!0,placeholder:"pilot@example.com",className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"הסמכת רתא"}),(0,s.jsxs)("select",{value:p,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[(0,s.jsx)("option",{value:"IP",children:"מטיס פנים (IP)"}),(0,s.jsx)("option",{value:"EP",children:"מטיס חוץ (EP)"}),(0,s.jsx)("option",{value:"BOTH",children:"שניהם"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"קטגוריה"}),(0,s.jsxs)("select",{value:g,onChange:e=>y(e.target.value),required:!0,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[(0,s.jsx)("option",{value:"כנף קבועה 25-2000 קג",children:"כנף קבועה 25-2000 קג"}),(0,s.jsx)("option",{value:"כנף קבועה 0-25 קג",children:"כנף קבועה 0-25 קג"}),(0,s.jsx)("option",{value:"כנף קבועה דו מנועי 25-2000 קג",children:"כנף קבועה דו מנועי 25-2000 קג"}),(0,s.jsx)("option",{value:"עילוי ממונע VTOL",children:"עילוי ממונע VTOL"}),(0,s.jsx)("option",{value:"רחפן 25-2000 קג",children:"רחפן 25-2000 קג"}),(0,s.jsx)("option",{value:"רחפן 0-25 קג",children:"רחפן 0-25 קג"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"תוקף תעודה רפואית"}),(0,s.jsx)("input",{type:"date",value:b,onChange:e=>f(e.target.value),required:!0,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"האם המטיס הוא מדריך מוסמך?"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"isInstructor",checked:!0===N,onChange:()=>j(!0),className:"ml-2 text-blue-500 focus:ring-blue-500"}),(0,s.jsx)("span",{className:"text-white",children:"כן"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"isInstructor",checked:!1===N,onChange:()=>j(!1),className:"ml-2 text-blue-500 focus:ring-blue-500"}),(0,s.jsx)("span",{className:"text-white",children:"לא"})]})]})]}),N&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"תוקף רישיון מדריך"}),(0,s.jsx)("input",{type:"date",value:v,onChange:e=>w(e.target.value),min:new Date().toISOString().split("T")[0],max:k(),required:N,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),(0,s.jsxs)("p",{className:"text-xs text-gray-400",children:["תאריך מקסימלי: ",k()," (שנתיים מהיום)"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"הגבלות ברישיון"}),(0,s.jsxs)("select",{value:E,onChange:e=>C(e.target.value),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[(0,s.jsx)("option",{value:"ללא",children:"ללא"}),(0,s.jsx)("option",{value:"שיגור והנצלה בלבד",children:"שיגור והנצלה בלבד"}),(0,s.jsx)("option",{value:"אחר",children:"אחר"})]})]}),"אחר"===E&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:"פרט את ההגבלות"}),(0,s.jsx)("textarea",{value:S,onChange:e=>I(e.target.value),rows:3,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none",placeholder:"הסבר על ההגבלות..."})]}),(0,s.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,s.jsx)("button",{type:"submit",className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl",children:D?"עדכן מטיס":"הוסף מטיס"}),(0,s.jsx)("button",{type:"button",onClick:r,className:"px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-xl font-semibold transition-all duration-300 border border-gray-600",children:"ביטול"})]})]})]})})}function ei(){let[e,t]=(0,a.useState)([]),[r,j]=(0,a.useState)(!1),[v,w]=(0,a.useState)(null),[E,C]=(0,a.useState)(!1),[S,I]=(0,a.useState)(null),[D,k]=(0,a.useState)(null),[L,O]=(0,a.useState)(!0),[F,J]=(0,a.useState)(!1),[M,B]=(0,a.useState)(!1);(0,a.useEffect)(()=>{B(Z())},[]),(0,a.useEffect)(()=>{(async()=>{try{O(!0);let e=await P();t(e),setTimeout(()=>{K(e)},2e3)}catch(e){console.error("Error loading pilots:",e)}finally{O(!1)}})()},[]);let H=function(e){let t=e.length,r=e.filter(e=>"IP"===e.rataCertification||"BOTH"===e.rataCertification),s=r.filter(e=>(0,N.$_)(e.healthCertificateExpiry)>0),a=e.filter(e=>"EP"===e.rataCertification||"BOTH"===e.rataCertification),i=a.filter(e=>(0,N.$_)(e.healthCertificateExpiry)>0),l=e.filter(e=>("IP"===e.rataCertification||"BOTH"===e.rataCertification)&&e.isInstructor),n=l.filter(e=>(e.instructorLicenseExpiry?(0,N.$_)(e.instructorLicenseExpiry):-1)>0),c=e.filter(e=>("EP"===e.rataCertification||"BOTH"===e.rataCertification)&&e.isInstructor),o=c.filter(e=>(e.instructorLicenseExpiry?(0,N.$_)(e.instructorLicenseExpiry):-1)>0),d=e.filter(e=>{let t=(0,N.$_)(e.healthCertificateExpiry),r=e.instructorLicenseExpiry?(0,N.$_)(e.instructorLicenseExpiry):null;return null!==t&&t<=45&&t>0||null!==r&&r<=45&&r>0}).length,x=e.filter(e=>{let t=(0,N.$_)(e.healthCertificateExpiry),r=e.instructorLicenseExpiry?(0,N.$_)(e.instructorLicenseExpiry):null;return null!==t&&t<=0||null!==r&&r<=0}).length;return{totalPilots:t,ipPilots:r.length,validIpPilots:s.length,epPilots:a.length,validEpPilots:i.length,ipInstructors:l.length,validIpInstructors:n.length,epInstructors:c.length,validEpInstructors:o.length,expiringPilots:d,expiredPilots:x}}(e),$=[{title:"מטיסים פעילים",value:H.totalPilots.toString(),icon:c.A,trend:"+3 החודש",color:"text-blue-400",bgColor:"bg-blue-500/10"},{title:"רישיונות מטיס פנים תקפים",value:"".concat(H.validIpPilots," מתוך ").concat(H.ipPilots),icon:o.A,trend:"+2 החודש",color:"text-emerald-400",bgColor:"bg-emerald-500/10"},{title:"רישיונות מטיס חוץ תקפים",value:"".concat(H.validEpPilots," מתוך ").concat(H.epPilots),icon:d.A,trend:"+1 החודש",color:"text-purple-400",bgColor:"bg-purple-500/10"},{title:"רישיונות מדריך מטיס פנים תקפים",value:"".concat(H.validIpInstructors," מתוך ").concat(H.ipInstructors),icon:o.A,trend:"מדריכים פעילים",color:"text-cyan-400",bgColor:"bg-cyan-500/10"},{title:"רישיונות מדריך מטיס חוץ תקפים",value:"".concat(H.validEpInstructors," מתוך ").concat(H.epInstructors),icon:d.A,trend:"מדריכים פעילים",color:"text-indigo-400",bgColor:"bg-indigo-500/10"},{title:"כמות רשיונות לא בתוקף",value:H.expiredPilots.toString(),icon:n.A,trend:"נדרש חידוש",color:"text-red-400",bgColor:"bg-red-500/10"}],q=async r=>{try{let s=await A(r);t([...e,s])}catch(e){console.error("Error adding pilot:",e)}},z=async r=>{if(v&&v.id)try{await _(v.id,r);let s=e.map(e=>e.id===v.id?{...e,...r}:e);t(s),w(null)}catch(e){console.error("Error updating pilot:",e)}},R=e=>{if(!Z())return void alert("\uD83D\uDEAB אין לך הרשאות מנהל למחיקת מטיסים. יש להתחבר כמנהל תחילה.");k(e)},Y=async()=>{if(D&&D.id)try{await T(D.id),t(e.filter(e=>e.id!==D.id)),k(null)}catch(e){console.error("Error deleting pilot:",e)}},U=e=>{let t=(0,N.go)(e.healthCertificateExpiry),r=(0,N.$_)(e.healthCertificateExpiry),s=null,a=null;return e.instructorLicenseExpiry&&(s=(0,N.go)(e.instructorLicenseExpiry),a=(0,N.$_)(e.instructorLicenseExpiry)),{healthStatus:t,healthDays:r,instructorStatus:s,instructorDays:a}},G=(e,t)=>(0,s.jsx)("span",{className:(0,N.cn)("px-2 py-1 text-xs rounded-full border",{expired:"bg-red-500/20 text-red-300 border-red-500/30",critical:"bg-orange-500/20 text-orange-300 border-orange-500/30",warning:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",good:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30"}[e]),children:t<0?"פג תוקף":"".concat(t," ימים")}),V=e.flatMap(e=>{let t=[],r=(0,N.$_)(e.healthCertificateExpiry);if(r<=45&&r>=0&&t.push({pilotName:"".concat(e.firstName," ").concat(e.lastName),type:"תעודה רפואית",days:r,date:e.healthCertificateExpiry}),e.instructorLicenseExpiry){let r=(0,N.$_)(e.instructorLicenseExpiry);r<=45&&r>=0&&t.push({pilotName:"".concat(e.firstName," ").concat(e.lastName),type:"רישיון מדריך",days:r,date:e.instructorLicenseExpiry})}return t}).sort((e,t)=>e.days-t.days);return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 relative overflow-hidden",style:{direction:"rtl"},children:[(0,s.jsxs)("div",{className:"absolute inset-0 opacity-30",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/10 to-purple-600/10"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-[linear-gradient(90deg,transparent_24%,rgba(255,255,255,0.05)_25%,rgba(255,255,255,0.05)_26%,transparent_27%,transparent_74%,rgba(255,255,255,0.05)_75%,rgba(255,255,255,0.05)_76%,transparent_77%,transparent)] bg-[length:50px_50px]"})]}),L&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-gray-900/95 backdrop-blur-lg border border-gray-700 rounded-2xl p-8 flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-400"}),(0,s.jsx)("p",{className:"text-white text-lg",children:"טוען נתונים..."})]})}),L&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"text-center text-white",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-400 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-lg",children:"טוען נתונים..."})]})}),(0,s.jsx)("header",{className:"relative z-10 bg-black/20 backdrop-blur-md border-b border-gray-700",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center h-14 sm:h-16",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("div",{className:"flex-shrink-0 flex items-center",children:[(0,s.jsx)(x.A,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-400"}),(0,s.jsx)("span",{className:"mr-2 text-lg sm:text-xl font-bold text-white hidden sm:block",children:"מערכת ניהול רישיונות"}),(0,s.jsx)("span",{className:"mr-2 text-sm font-bold text-white sm:hidden",children:"ניהול רישיונות"})]})}),(0,s.jsx)(es,{onAdminStatusChange:B})]})})}),(0,s.jsx)("main",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 sm:mb-8 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-white mb-2",children:"לוח בקרה"}),(0,s.jsx)("p",{className:"text-gray-400 text-sm sm:text-base",children:"ניהול רישיונות מטיסים ותעודות רפואיות"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(i.P.button,{onClick:()=>C(!E),className:"group ".concat(E?"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700":"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700"," text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center gap-2 text-sm sm:text-base"),whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,s.jsx)(m.A,{className:"w-4 h-4 sm:w-5 sm:h-5"}),E?"הסתר סטטיסטיקה":"סטטיסטיקה"]}),(0,s.jsxs)(i.P.button,{onClick:()=>{if(!Z())return void alert("\uD83D\uDEAB אין לך הרשאות מנהל לגישה לאזור התראות המייל. יש להתחבר כמנהל תחילה.");J(!0)},className:"group bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center gap-2 text-sm sm:text-base",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,s.jsx)(u.A,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"התראות מייל"]}),(0,s.jsxs)(i.P.button,{onClick:()=>j(!0),className:"group bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center gap-2 text-sm sm:text-base",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,s.jsx)(p.A,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"הוסף מטיס"]})]})]}),E&&(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4 sm:gap-6 mb-8",children:$.map((e,t)=>(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1*t},className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700 rounded-xl p-6 hover:bg-gray-800/60 transition-all duration-300",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:(0,N.cn)("p-3 rounded-lg",e.bgColor),children:(0,s.jsx)(e.icon,{className:(0,N.cn)("h-6 w-6",e.color)})}),(0,s.jsxs)("div",{className:"mr-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-400",children:e.title}),(0,s.jsx)("p",{className:"text-2xl font-semibold text-white",children:e.value})]})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)("p",{className:"text-sm text-gray-500",children:e.trend})})]},e.title))}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 lg:gap-6",children:[(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},className:"lg:col-span-3 bg-gray-800/40 backdrop-blur-sm border border-gray-700 rounded-xl overflow-hidden order-2 lg:order-1",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-700",children:(0,s.jsx)("h2",{className:"text-lg font-semibold text-white",children:"רשימת מטיסים"})}),(0,s.jsx)("div",{className:"block lg:hidden",children:(0,s.jsx)("div",{className:"space-y-4 p-4",children:e.sort((e,t)=>"IP"===e.rataCertification&&"IP"!==t.rataCertification?-1:+("IP"===t.rataCertification&&"IP"!==e.rataCertification)).map((e,t)=>{let{healthStatus:r,healthDays:a,instructorStatus:l,instructorDays:n}=U(e);return(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*t},className:"bg-gray-700/30 rounded-xl p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-2 bg-blue-500/20 rounded-lg ml-3",children:(0,s.jsx)(h.A,{className:"h-4 w-4 text-blue-400"})}),(0,s.jsx)("div",{children:(0,s.jsxs)("button",{onClick:()=>I(e),className:"text-sm font-medium text-white hover:text-blue-400 transition-colors cursor-pointer",children:[e.firstName," ",e.lastName]})})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>w(e),className:"text-blue-400 hover:text-blue-300 transition-colors flex items-center gap-1",children:[(0,s.jsx)(g.A,{className:"h-3 w-3"}),(0,s.jsx)("span",{className:"text-xs",children:"עריכה"})]}),(0,s.jsxs)("button",{onClick:()=>R(e),className:"text-red-400 hover:text-red-300 transition-colors flex items-center gap-1",children:[(0,s.jsx)(y.A,{className:"h-3 w-3"}),(0,s.jsx)("span",{className:"text-xs",children:"מחק"})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-1",children:[("IP"===e.rataCertification||"BOTH"===e.rataCertification)&&(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-emerald-500/20 text-emerald-300",children:"מטיס פנים"}),("EP"===e.rataCertification||"BOTH"===e.rataCertification)&&(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-300",children:"מטיס חוץ"}),e.isInstructor&&(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-500/20 text-blue-300",children:"מדריך"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"תעודה רפואית: "}),(0,s.jsx)("span",{className:"text-gray-300",children:(0,N.Yq)(e.healthCertificateExpiry)}),(0,s.jsx)("div",{className:"mt-1",children:G(r,a)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"רישיון מדריך: "}),e.isInstructor&&e.instructorLicenseExpiry?(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-300",children:(0,N.Yq)(e.instructorLicenseExpiry)}),(0,s.jsx)("div",{className:"mt-1",children:G(l,n)})]}):e.isInstructor?(0,s.jsx)("span",{className:"text-yellow-400",children:"חסר תאריך"}):(0,s.jsx)("span",{className:"text-gray-500",children:"לא מדריך"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"הגבלות: "}),(0,s.jsx)("span",{className:"text-gray-300",children:"אחר"===e.restrictions?e.customRestrictions:e.restrictions})]})]})]},e.id)})})}),(0,s.jsx)("div",{className:"hidden lg:block overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-800/60",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"מטיס"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"הסמכה"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"תעודה רפואית"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"רישיון מדריך"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"הגבלות"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"פעולות"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-700",children:e.sort((e,t)=>"IP"===e.rataCertification&&"IP"!==t.rataCertification?-1:+("IP"===t.rataCertification&&"IP"!==e.rataCertification)).map((e,t)=>{let{healthStatus:r,healthDays:a,instructorStatus:l,instructorDays:n}=U(e);return(0,s.jsxs)(i.P.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*t},className:"hover:bg-gray-700/30 transition-colors",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-2 bg-blue-500/20 rounded-lg ml-3",children:(0,s.jsx)(h.A,{className:"h-4 w-4 text-blue-400"})}),"                              ",(0,s.jsx)("div",{children:(0,s.jsxs)("button",{onClick:()=>I(e),className:"text-sm font-medium text-white hover:text-blue-400 transition-colors cursor-pointer",children:[e.firstName," ",e.lastName]})})]})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex flex-wrap gap-1",children:[("IP"===e.rataCertification||"BOTH"===e.rataCertification)&&(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-500/20 text-emerald-300 whitespace-nowrap",children:"מטיס פנים"}),("EP"===e.rataCertification||"BOTH"===e.rataCertification)&&(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-500/20 text-purple-300 whitespace-nowrap",children:"מטיס חוץ"}),e.isInstructor&&(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-500/20 text-blue-300 whitespace-nowrap",children:"מדריך"})]})}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,s.jsx)("div",{className:"text-sm text-gray-300",children:(0,N.Yq)(e.healthCertificateExpiry)}),G(r,a)]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.isInstructor&&e.instructorLicenseExpiry?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-gray-300",children:(0,N.Yq)(e.instructorLicenseExpiry)}),G(l,n)]}):e.isInstructor?(0,s.jsx)("span",{className:"text-yellow-400",children:"חסר תאריך"}):(0,s.jsx)("span",{className:"text-gray-500",children:"לא מדריך"})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("div",{className:"text-sm text-gray-300 max-w-xs",children:"אחר"===e.restrictions?e.customRestrictions:e.restrictions})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("button",{onClick:()=>w(e),className:"text-blue-400 hover:text-blue-300 transition-colors flex items-center gap-1 px-2 py-1 rounded hover:bg-blue-500/10",children:[(0,s.jsx)(g.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-xs",children:"עריכה"})]}),(0,s.jsxs)("button",{onClick:()=>R(e),className:"text-red-400 hover:text-red-300 transition-colors flex items-center gap-1 px-2 py-1 rounded hover:bg-red-500/10",children:[(0,s.jsx)(y.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-xs",children:"מחק"})]})]})})]},e.id)})})]})})]}),(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.5},className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700 rounded-xl order-1 lg:order-2",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b border-gray-700",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-white",children:"פגים בקרוב"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"45 יום קדימה"})]}),(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)("div",{className:"space-y-4",children:0===V.length?(0,s.jsxs)("div",{className:"text-center py-4",children:[(0,s.jsx)(b.A,{className:"h-12 w-12 text-emerald-400 mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"אין פגים בקרוב"})]}):V.slice(0,5).map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-700/30 rounded-lg",children:[(0,s.jsx)("div",{className:"p-2 bg-orange-500/20 rounded-lg",children:(0,s.jsx)(f.A,{className:"h-4 w-4 text-orange-400"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-white",children:e.pilotName}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:e.type}),(0,s.jsxs)("p",{className:"text-xs text-orange-400",children:[e.days," ימים נותרו"]})]})]},t))})})]})]})]})}),(0,s.jsx)(l.N,{children:r&&(0,s.jsx)(ea,{onSubmit:q,onClose:()=>j(!1)})}),(0,s.jsx)(l.N,{children:v&&(0,s.jsx)(ea,{onSubmit:z,onClose:()=>w(null),initialData:v})}),(0,s.jsx)(l.N,{children:D&&(0,s.jsx)(i.P.div,{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{direction:"rtl"},children:(0,s.jsx)(i.P.div,{className:"bg-gray-900/95 backdrop-blur-lg border border-gray-700 rounded-2xl p-6 max-w-xs w-full mx-4 relative shadow-2xl",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-500/20 mb-4",children:(0,s.jsx)(y.A,{className:"h-6 w-6 text-red-400"})}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"מחיקת מטיס"}),(0,s.jsxs)("p",{className:"text-gray-400 mb-6",children:["האם אתה בטוח שברצונך למחוק את המטיס ",D.firstName," ",D.lastName,"?",(0,s.jsx)("br",{}),"פעולה זו לא ניתנת לביטול."]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{onClick:Y,className:"flex-1 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300",children:"כן, מחק"}),(0,s.jsx)("button",{onClick:()=>{k(null)},className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 border border-gray-600",children:"ביטול"})]})]})})})}),(0,s.jsx)(l.N,{children:S&&(0,s.jsx)(i.P.div,{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{direction:"rtl"},children:(0,s.jsxs)(i.P.div,{className:"bg-gray-900/95 backdrop-blur-lg border border-gray-700 rounded-2xl p-6 max-w-sm w-full mx-4 relative shadow-2xl max-h-[90vh] overflow-y-auto",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[(0,s.jsx)("button",{onClick:()=>I(null),className:"absolute top-4 left-4 p-2 hover:bg-gray-800 rounded-full transition-colors",children:(0,s.jsx)(n.A,{className:"w-5 h-5 text-gray-400"})}),(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsx)("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-blue-500/20 mb-4",children:(0,s.jsx)(h.A,{className:"h-8 w-8 text-blue-400"})}),(0,s.jsxs)("h3",{className:"text-2xl font-bold text-white mb-2",children:[S.firstName," ",S.lastName]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-gray-800/40 rounded-xl p-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"הסמכת רתא"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[("IP"===S.rataCertification||"BOTH"===S.rataCertification)&&(0,s.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-emerald-500/20 text-emerald-300",children:"מטיס פנים"}),("EP"===S.rataCertification||"BOTH"===S.rataCertification)&&(0,s.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-purple-500/20 text-purple-300",children:"מטיס חוץ"}),S.isInstructor&&(0,s.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-500/20 text-blue-300",children:"מדריך"})]})]}),(0,s.jsxs)("div",{className:"bg-gray-800/40 rounded-xl p-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"קטגוריה"}),(0,s.jsx)("p",{className:"text-white",children:S.category.replace(/&quot;/g,'"')})]}),(0,s.jsxs)("div",{className:"bg-gray-800/40 rounded-xl p-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"תעודה רפואית"}),(0,s.jsx)("p",{className:"text-white",children:(0,N.Yq)(S.healthCertificateExpiry)}),(0,s.jsx)("div",{className:"mt-2",children:(()=>{let e=(0,N.$_)(S.healthCertificateExpiry);return G((0,N.go)(S.healthCertificateExpiry),e)})()})]}),S.isInstructor&&(0,s.jsxs)("div",{className:"bg-gray-800/40 rounded-xl p-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"רישיון מדריך"}),S.instructorLicenseExpiry?(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-white",children:(0,N.Yq)(S.instructorLicenseExpiry)}),(0,s.jsx)("div",{className:"mt-2",children:(()=>{let e=(0,N.$_)(S.instructorLicenseExpiry);return G((0,N.go)(S.instructorLicenseExpiry),e)})()})]}):(0,s.jsx)("p",{className:"text-yellow-400",children:"חסר תאריך"})]}),(0,s.jsxs)("div",{className:"bg-gray-800/40 rounded-xl p-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"הגבלות"}),(0,s.jsx)("p",{className:"text-white",children:"אחר"===S.restrictions?S.customRestrictions:S.restrictions})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsxs)("button",{onClick:()=>{w(S),I(null)},className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2",children:[(0,s.jsx)(g.A,{className:"w-4 h-4"}),"עריכה"]}),(0,s.jsxs)("button",{onClick:()=>{if(!Z())return void alert("\uD83D\uDEAB אין לך הרשאות מנהל למחיקת מטיסים. יש להתחבר כמנהל תחילה.");k(S),I(null)},className:"flex-1 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2",children:[(0,s.jsx)(y.A,{className:"w-4 h-4"}),"מחק"]})]})]})})}),(0,s.jsx)(l.N,{children:F&&(0,s.jsx)(er,{pilots:e,onClose:()=>J(!1)})})]})}},9434:(e,t,r)=>{"use strict";r.d(t,{$_:()=>n,Yq:()=>l,cn:()=>i,go:()=>c});var s=r(2596),a=r(9688);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}function l(e){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(e)}function n(e){let t=new Date;return Math.ceil((new Date(e).getTime()-t.getTime())/864e5)}function c(e){let t=n(e);return t<0?"expired":t<=7?"critical":t<=30?"warning":"good"}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,811,436,393,441,684,358],()=>t(682)),_N_E=e.O()}]);